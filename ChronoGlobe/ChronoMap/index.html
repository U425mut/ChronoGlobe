<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChronoGlobe - Tarihsel DÃ¼nya KeÅŸfi</title>

  <!-- Stil DosyalarÄ± -->
  <link rel="stylesheet" href="style/style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- Meta Etiketleri -->
  <meta name="description" content="ChronoGlobe â€“ EtkileÅŸimli tarihsel dÃ¼nya haritasÄ± ve zaman kontrolÃ¼." />
  <meta name="keywords" content="harita, tarih, zaman Ã§izgisi, ChronoGlobe, dÃ¼nya haritasÄ±" />
  <meta name="author" content="Umut" />


</head>
<body>
  
  <div class="app-container">

    <!-- ğŸ•’ Zaman Kontrol Paneli -->
<header class="time-controller">
  <div class="left-section">
    <div class="country-search-wrapper">
      <input type="text" id="country-search" placeholder="Ãœlke ara..." autocomplete="off" aria-label="Ãœlke arama kutusu" />
      <ul id="country-search-results"></ul>
    </div>

<!-- ğŸŒŸ Davet kutusu: Ã¼lke aramasÄ±nÄ±n SAÄINA -->
<div id="invite-cta" class="hidden" role="complementary" aria-label="ChronoGlobe KatkÄ± Daveti">
  <a href="https://github.com/U425mut/ChronoGlobe" target="_blank" class="invite-link">
    ChronoGlobe topluluÄŸuna katÄ±l!
  </a>  AÃ§Ä±k kaynak bir dÃ¼nya projesi: haritalarÄ± sen tasarla, verileri sen ekle,
</div>

<!-- ğŸŒŸ /Davet kutusu -->



  </div>

  <div class="right-section">
    <div class="year-nav">
      <button id="btn-prev" aria-label="Ã–nceki YÄ±l">&#9664;</button>
      <span id="current-year">2025</span>
      <button id="btn-next" aria-label="Sonraki YÄ±l">&#9654;</button>
    </div>
    <div class="year-slider-wrapper">
      <label for="year-slider">YÄ±l:</label>
      <input type="range" id="year-slider" min="2012" max="2025" value="2025" step="1" />
      <span id="year-slider-value">2025</span>
    </div>
  </div>
</header>




    <!-- ğŸŒ Harita AlanÄ± -->
    <main class="world-screen">
      <div class="map-frame">
        <div id="leaflet-map"></div>
      </div>
    </main>

    <!-- ğŸ“Œ KÃ¼Ã§Ã¼k Navigasyon Paneli -->
    <div id="mini-nav-panel" style="display:none;">
      <button data-scroll="history-section">Ãœlke HakkÄ±nda</button>
      <button data-scroll="events-section">Bu YÄ±l Ne OlmuÅŸ?</button>
      <div id="about-submenu" style="display:none;">
        <button data-scroll="kurulus">KuruluÅŸ ve Erken DÃ¶nemler</button>
        <button data-scroll="cografi">CoÄŸrafi Konum ve Stratejik Ã–nemi</button>
        <button data-scroll="siyasi">Siyasi GeliÅŸim SÃ¼reci</button>
        <button data-scroll="toplumsal">Toplumsal YapÄ± ve KÃ¼ltÃ¼r</button>
        <button data-scroll="ekonomik">Ekonomik YapÄ± ve DÃ¶nÃ¼ÅŸÃ¼m</button>
        <button data-scroll="bilim">Bilim, EÄŸitim ve Teknoloji Tarihi</button>
        <button data-scroll="sanat">Sanat, Edebiyat ve Estetik KÃ¼ltÃ¼rÃ¼</button>
        <button data-scroll="askeri">Askeri Tarih ve SavaÅŸlar</button>
        <button data-scroll="diplomasi">Diplomasi ve UluslararasÄ± Ä°liÅŸkiler</button>
        <button data-scroll="modernlesme">ModernleÅŸme SÃ¼reci ve Reformlar</button>
        <button data-scroll="cagdas">Ã‡aÄŸdaÅŸ DÃ¶nem ve GÃ¼nÃ¼mÃ¼zdeki Durumu</button>
        <button data-scroll="miras">Tarihsel Miras ve KÃ¼resel Etki</button>
      </div>
    </div>

  </div>

  <!-- â„¹ï¸ Bilgi Paneli -->
  <aside id="info-panel" class="draggable resizable">

    <header class="info-header">
      <h2 id="country-name">Ãœlke AdÄ±</h2>
      <h3 id="selected-year">YÄ±l: 2025</h3>
      <nav class="info-controls">
        <button id="btn-expand" aria-label="Paneli bÃ¼yÃ¼t/kÃ¼Ã§Ã¼lt">â›¶</button>
        <button id="btn-close" aria-label="Paneli kapat">âœ•</button>
      </nav>
    </header>

    <!-- Temel Bilgiler -->
    <section class="info-columns">
      <div class="column-left">
        <p><strong>BaÅŸkent:</strong> <span id="capital">Bilinmiyor</span></p>
        <p><strong>NÃ¼fus:</strong> <span id="population">Bilinmiyor</span></p>
        <p><strong>YÃ¼zÃ¶lÃ§Ã¼mÃ¼:</strong> <span id="area">Bilinmiyor</span></p>
        <p><strong>NÃ¼fus YoÄŸunluÄŸu:</strong> <span id="populationDensity">Bilinmiyor</span></p>
        <p><strong>KuruluÅŸ:</strong> <span id="founded">Bilinmiyor</span></p>
        <p><strong>Diller:</strong> <span id="languages">Bilinmiyor</span></p>
        <p><strong>Resmi Din:</strong> <span id="religion">Bilinmiyor</span></p>
      </div>
      <div class="column-right">
        <p><strong>YÃ¶netim BiÃ§imi:</strong> <span id="government">Bilinmiyor</span></p>
        <p><strong>KÄ±ta:</strong> <span id="continent">Bilinmiyor</span></p>
        <p><strong>Para Birimi:</strong> <span id="currency">Bilinmiyor</span></p>
        <p><strong>Telefon Kodu:</strong> <span id="callingCode">Bilinmiyor</span></p>
        <p><strong>Ä°nternet Alan Kodu:</strong> <span id="internetCode">Bilinmiyor</span></p>
        <p><strong>KomÅŸular:</strong> <span id="borders">Bilinmiyor</span></p>
      </div>
    </section>

    <!-- Ãœlke HakkÄ±nda -->
    <section id="history-section">
      <h3>Ãœlke HakkÄ±nda</h3>
      <div id="history">
        <section id="kurulus" class="history-subsection">
          <h4>KuruluÅŸ ve Erken DÃ¶nemler</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="cografi" class="history-subsection">
          <h4>CoÄŸrafi Konum ve Stratejik Ã–nemi</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="siyasi" class="history-subsection">
          <h4>Siyasi GeliÅŸim SÃ¼reci</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="toplumsal" class="history-subsection">
          <h4>Toplumsal YapÄ± ve KÃ¼ltÃ¼r</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="ekonomik" class="history-subsection">
          <h4>Ekonomik YapÄ± ve DÃ¶nÃ¼ÅŸÃ¼m</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="bilim" class="history-subsection">
          <h4>Bilim, EÄŸitim ve Teknoloji Tarihi</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="sanat" class="history-subsection">
          <h4>Sanat, Edebiyat ve Estetik KÃ¼ltÃ¼rÃ¼</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="askeri" class="history-subsection">
          <h4>Askeri Tarih ve SavaÅŸlar</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="diplomasi" class="history-subsection">
          <h4>Diplomasi ve UluslararasÄ± Ä°liÅŸkiler</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="modernlesme" class="history-subsection">
          <h4>ModernleÅŸme SÃ¼reci ve Reformlar</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="cagdas" class="history-subsection">
          <h4>Ã‡aÄŸdaÅŸ DÃ¶nem ve GÃ¼nÃ¼mÃ¼zdeki Durumu</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
        <section id="miras" class="history-subsection">
          <h4>Tarihsel Miras ve KÃ¼resel Etki</h4>
          <p>HenÃ¼z bilgi yok.</p>
        </section>
      </div>
    </section>

    <!-- Bu yÄ±l ne olmuÅŸ -->
    <section id="events-section" class="history-subsection">
      <h3>Bu yÄ±l ne olmuÅŸ?</h3>
      <ul id="events-list">
        <li>HenÃ¼z bilgi yok.</li>
      </ul>
    </section>

  </aside>

  <!-- Paneli tekrar aÃ§ma butonu -->
  <button id="reopen-panel" style="display:none;">â„¹ï¸</button>



<!-- JS KÃ¼tÃ¼phaneleri -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="js/map.js"></script>
<script type="module" src="js/app.js"></script>

<script>
  (() => {
    let countryNamesTR = {};
    let geoJsonCountries = null;

    const countrySearchInput = document.getElementById("country-search");
    const countrySearchResults = document.getElementById("country-search-results");

    // YÃ¼klenen Ã¼lke isimlerini kÃ¼Ã§Ã¼ltÃ¼lmÃ¼ÅŸ ve hÄ±zlÄ± arama iÃ§in tutacaÄŸÄ±z
    let searchableCountryNames = [];

    // SeÃ§ilen Ã¼lkeyi global saklama
    window.currentCountryEvent = null;

    // Ãœlke isimlerini yÃ¼kle
    async function loadCountryNamesTR() {
      const res = await fetch("data/country-names-tr.json");
      if (!res.ok) throw new Error("country-names-tr.json yÃ¼klenemedi");
      countryNamesTR = await res.json();
    }

    // countries.geo.json dosyasÄ±nÄ± yÃ¼kle
    async function loadGeoJsonCountries() {
      const res = await fetch("data/countries.geo.json");
      if (!res.ok) throw new Error("countries.geo.json yÃ¼klenemedi");
      const geoJson = await res.json();
      geoJsonCountries = geoJson.features || [];
    }

    // Arama sonuÃ§larÄ±nÄ± gÃ¶ster
    function showSearchResults(results) {
      if (!results.length) {
        countrySearchResults.style.display = "none";
        countrySearchResults.innerHTML = "";
        return;
      }
      countrySearchResults.innerHTML = results
        .map(cn => `<li class="search-item">${cn.tr}</li>`)
        .join("");
      countrySearchResults.style.display = "block";

      // Click olaylarÄ±nÄ± ata
      document.querySelectorAll(".search-item").forEach(item => {
        item.addEventListener("click", () => {
          onCountrySelectedFromSearch(item.textContent);
        });
      });
    }

    // KullanÄ±cÄ± arama kutusuna yazdÄ±ÄŸÄ±nda filtrele
    countrySearchInput.addEventListener("input", () => {
      const val = countrySearchInput.value.trim().toLowerCase();
      if (!val) {
        showSearchResults([]);
        return;
      }
      const filtered = searchableCountryNames.filter(cn => cn.tr.toLowerCase().includes(val)).slice(0, 10);
      showSearchResults(filtered);
    });

    // Arama dÄ±ÅŸÄ±na tÄ±klanÄ±nca listeyi gizle
    document.addEventListener("click", (e) => {
      if (!countrySearchInput.contains(e.target) && !countrySearchResults.contains(e.target)) {
        countrySearchResults.style.display = "none";
      }
    });

    // Aramadan Ã¼lke seÃ§ildiÄŸinde yapÄ±lacaklar
    async function onCountrySelectedFromSearch(trName) {
      countrySearchInput.value = trName;
      countrySearchResults.style.display = "none";

      // Ä°ngilizce adÄ± bul (geoJsonCountries'da properties.name alanÄ±)
      const found = geoJsonCountries.find(c =>
        (countryNamesTR[c.properties.name] || c.properties.name) === trName
      );

      if (!found) {
        alert("Ãœlke bulunamadÄ±.");
        return;
      }

      const engName = found.properties.name;

      window.currentCountryEvent = { name: engName };
      document.getElementById("country-name").textContent = trName;
      const year = Number(document.getElementById("year-slider").value);
      document.getElementById("selected-year").textContent = `YÄ±l: ${year}`;

      // Haritada Ã¼lkeyi seÃ§ (map.js iÃ§indeki fonksiyonu Ã§aÄŸÄ±r)
      if (window.selectCountryOnMap) {
        window.selectCountryOnMap(engName);
      }

      // country:selected eventini tetikle (diÄŸer modÃ¼ller iÃ§in)
      window.dispatchEvent(new CustomEvent("country:selected", { detail: { name: engName } }));
    }

    // Sayfa yÃ¼klendiÄŸinde verileri yÃ¼kle ve hazÄ±rla
    document.addEventListener("DOMContentLoaded", async () => {
      try {
        await loadCountryNamesTR();
        await loadGeoJsonCountries();

        // searchableCountryNames oluÅŸtur (geoJsonCountries + tr isim eÅŸlemesi)
        searchableCountryNames = geoJsonCountries.map(c => ({
          eng: c.properties.name,
          tr: countryNamesTR[c.properties.name] || c.properties.name
        }));

      } catch (err) {
        console.error(err);
      }
    });
  })();

  // DiÄŸer mevcut scriptler zaten burada, onlarÄ± koruyabiliriz
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
  initPanelControls();
  initYearControls();

  // ğŸš€ Davet kutusu animasyonu
  const invite = document.getElementById("invite-cta");
  if (invite) {
    setTimeout(() => {
      invite.classList.remove("hidden");
      invite.classList.add("crash");
    }, 300); // sayfa aÃ§Ä±ldÄ±ktan 0.3 sn sonra baÅŸlasÄ±n

    // ğŸš€ SÃ¼rÃ¼klenebilirlik ekle
    makeDraggable(invite);
  }


});


  // Ãœlke seÃ§ildiÄŸinde Ã§alÄ±ÅŸÄ±r (country-info.json'dan verileri alÄ±r)
  window.addEventListener("country:selected", (event) => {
    const { name } = event.detail;
    const year = Number(document.getElementById("year-slider").value);

    // Ãœlke adÄ±nÄ± tÃ¼rkÃ§eye Ã§evir
    fetch("data/country-names-tr.json")
      .then(res => res.json())
      .then(countryNamesTR => {
        const translatedName = countryNamesTR[name] || name;
        document.getElementById("country-name").textContent = translatedName;
      })
      .catch(err => {
        console.error("Ãœlke isimleri Ã§evirisi yÃ¼klenemedi:", err);
        document.getElementById("country-name").textContent = name;
      });

    document.getElementById("selected-year").textContent = `YÄ±l: ${year}`;

    // Ãœlke verilerini JSON'dan Ã§ek
    fetch("data/country-info.json")
      .then(res => {
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        return res.json();
      })
      .then(json => {
        const countryData = json[name];
        const yearData = countryData?.years?.[year] || {};

        const updateField = (id, value, fallback = "Bilinmiyor") => {
          const el = document.getElementById(id);
          if (el) el.textContent = (value !== undefined && value !== null) ? value : fallback;
        };

        // Sabit alanlar + nÃ¼fus/alan/yoÄŸunluk country-info.json'dan
        [
          "capital", "founded", "languages", "government", "religion",
          "continent", "currency", "callingCode", "internetCode", "borders",
          "population", "area", "populationDensity"
        ].forEach(id => updateField(id, yearData[id]));

        // ğŸ“œ TarihÃ§e
        // ğŸ“œ TarihÃ§e
     const historyEl = document.getElementById("history");
     if (countryData.content && typeof countryData.content === "object") {
       const html = Object.entries(countryData.content)
         .map(([title, text]) => `
           <div class="history-section">
             <h4>${title}</h4>
             <p>${text || "Bilgi bulunamadÄ±."}</p>
           </div>
         `).join("");
       historyEl.innerHTML = html;
     } else {
       historyEl.textContent = "HenÃ¼z tarihsel bilgi bulunamadÄ±.";
     }
     

        // ğŸ“… Bu yÄ±l ne olmuÅŸ? (events.json'dan al)
        fetch("data/events.json")
          .then(res => {
            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            return res.json();
          })
          .then(eventsData => {
            const eventsForYear = eventsData[name]?.[year] || ["Bu yÄ±l iÃ§in kayÄ±tlÄ± olay yok."];
            const eventsListEl = document.getElementById("events-list");
            if (eventsListEl) {
              eventsListEl.innerHTML = eventsForYear.map(e => `<li>${e}</li>`).join("");
            }
          })
          .catch(err => console.error("events.json yÃ¼klenemedi:", err));

      })
      .catch(err => console.error("country-info.json yÃ¼klenemedi:", err));
  });

  function initPanelControls() {
    const panel = document.getElementById("info-panel");
    const btnExpand = document.getElementById("btn-expand");
    const btnClose = document.getElementById("btn-close");
    const btnReopen = document.getElementById("reopen-panel");

    if (btnExpand) {
      btnExpand.addEventListener("click", () => {
        panel.classList.toggle("fullscreen");
        btnExpand.textContent = panel.classList.contains("fullscreen") ? "â¤«" : "â›¶";
      });
    }

    if (btnClose) {
      btnClose.addEventListener("click", () => {
        panel.style.display = "none";
        if (btnReopen) btnReopen.style.display = "block";
      });
    }

    if (btnReopen) {
      btnReopen.addEventListener("click", () => {
        panel.style.display = "block";
        btnReopen.style.display = "none";
      });
    }
  }

  function initYearControls() {
    const slider = document.getElementById("year-slider");
    const currentYear = document.getElementById("current-year");
    const yearValue = document.getElementById("year-slider-value");
    const selectedYear = document.getElementById("selected-year");
    const footerYear = document.getElementById("footer-year");
    const btnPrev = document.getElementById("btn-prev");
    const btnNext = document.getElementById("btn-next");

    // gÃ¼venli parse helper
    const toInt = (v, fallback = 0) => {
      const n = Number(v);
      return Number.isNaN(n) ? fallback : n;
    };

    const updateYear = (year) => {
      year = toInt(year, 2025);
      if (currentYear) currentYear.textContent = year;
      if (yearValue) yearValue.textContent = year;
      if (selectedYear) selectedYear.textContent = `YÄ±l: ${year}`;
      if (footerYear) footerYear.textContent = year;
      if (slider) slider.value = year;

      // app.js veya diÄŸer modÃ¼llere haber ver
      window.dispatchEvent(new CustomEvent("year:changed", { detail: { year } }));

      // EÄŸer Ã¼lke seÃ§iliyse bilgileri gÃ¼ncelle
      if (window.currentCountryEvent) {
        window.dispatchEvent(new CustomEvent("country:selected", { detail: window.currentCountryEvent }));
      }
    };

    if (slider) {
      slider.addEventListener("input", (e) => updateYear(toInt(e.target.value)));
    }

    if (btnPrev) {
      btnPrev.addEventListener("click", () => {
        const min = toInt(slider.min, 2012);
        const val = toInt(slider.value, 2025);
        updateYear(Math.max(min, val - 1));
      });
    }

    if (btnNext) {
      btnNext.addEventListener("click", () => {
        const max = toInt(slider.max, 2025);
        const val = toInt(slider.value, 2025);
        updateYear(Math.min(max, val + 1));
      });
    }

   // baÅŸlangÄ±Ã§ deÄŸeri
  updateYear(toInt(slider?.value ?? 2025));
}

function makeDraggable(el) {
  if (!el) return;
  let isDragging = false;
  let startX, startY;
  let currentX = 0, currentY = 0;

  el.addEventListener("mousedown", (e) => {
    isDragging = true;
    startX = e.clientX - currentX;
    startY = e.clientY - currentY;
    el.classList.add("dragging");
  });

  document.addEventListener("mousemove", (e) => {
    if (!isDragging) return;
    currentX = e.clientX - startX;
    currentY = e.clientY - startY;
    el.style.transform = `translate(${currentX}px, ${currentY}px)`;
  });

  document.addEventListener("mouseup", () => {
    if (!isDragging) return;
    isDragging = false;
    el.classList.remove("dragging");
    // bÄ±rakÄ±nca baÅŸlangÄ±Ã§ konumuna animasyonla dÃ¶n
    currentX = 0;
    currentY = 0;
    el.style.transform = `translate(0,0)`;
  });
}

// SeÃ§ilen Ã¼lkeyi globalde sakla (slider yÄ±l deÄŸiÅŸiminde yeniden yayÄ±nlama iÃ§in)
window.addEventListener("country:selected", (e) => {
  window.currentCountryEvent = e.detail;
});


  // Mini nav scroll eventleri
  document.querySelectorAll('#mini-nav-panel [data-scroll]').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.getAttribute('data-scroll');
      const el = document.getElementById(id);
      if (el) {
        el.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
</script>

<!-- ğŸ“œ Lisans Bilgisi -->
<footer style="text-align:center; font-size:12px; margin-top:20px; padding:10px; color:#666;">
  <p>
    Harita verileri: <a href="https://www.openstreetmap.org/copyright" target="_blank">Â© OpenStreetMap katkÄ±da bulunanlar</a> |
    Harita kÃ¼tÃ¼phanesi: <a href="https://leafletjs.com/" target="_blank">Leaflet (MIT LisansÄ±)</a>
  </p>
</footer>

</body>
</html>
<!--bu benim ilk denemem-->